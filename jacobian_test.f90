program jacobian_test

  use jacobian_f77_matlab

  implicit none
  real*8, dimension(6,6) :: C
  real*8, dimension(6) :: eTotal_cr, ec_cr
  real*8, dimension(3) :: tbar_cr
  real*8, dimension(3,3) :: result
  real*8 :: e22, x, alpha, lch, GIIc, GIc, eta

!   C = 0.0d0
!   C(1,1) = 83.4654904587297d0
!   C(1,2) = 3.11992755363710d0
!   C(1,3) = 3.11992755363710d0
!   C(2,2) = 9.99982098790910d0
!   C(2,3) = 4.76172574981386d0
!   C(3,3) = 9.99982098790910d0
!   C(4,4) = 6.47000000000000d0
!   C(5,5) = 3.5d0
!   C(6,6) = 6.47d0
!   eta = 1.45d0
!   alpha = 1.37881010907552d0
!   lch = 1.00502458838063d0
!   GIc = 0.1d0
!   GIIc = 3.0d-4
!   e22 = 7.7d0
!   eTotal_cr(1) = 2.604713340655021d-002
!   eTotal_cr(2) = -5.505555810078023d-003
!   eTotal_cr(3) = -5.505555810078023d-003
!   eTotal_cr(4) = -4.235821198543642d-022
!   eTotal_cr(5) = 1.045701209432247d-021
!   eTotal_cr(6) = 1.820553897296562d-021
!   ec_cr = 0.0d0
!   ec_cr(2) = 1.075982801850006d-007
!   ec_cr(4) = -5.302694461785174d-022
!   ec_cr(5) = 1.083949357049625d-018
!   tbar_cr(1) = 4.184479366209085d-021
!   tbar_cr(2) = 3.430434285843303d-002
!   tbar_cr(3) = 2.705608424223070d-021

  C = 0.0d0
  C(1,1) = 128.105941640294d0
  C(2,1) = 4.54488915760888d0
  C(3,1) = 4.54488915760888d0
  C(1,2) = 4.54488915760888d0
  C(2,2) = 12.6338294009132d0
  C(3,2) = 6.64698729565006
  C(1,3) = 4.54488915760888d0
  C(2,3) = 6.64698729565006d0
  C(3,3) = 12.6338294009132d0
  C(4,4) = 5.30000000000000d0
  C(5,5) = 3.00000000000000d0
  C(6,6) = 5.30000000000000d0
  eta = 1.45d0
  alpha = 1.745329251994330d-002
  lch = 1.00370460978560d0
  GIc = 2.770000000000000d-004
  GIIc = 7.880000000000000d-004
  e22 = 9.10000000000d0
  eTotal_cr(1) = 2.098896740713027120328604269161588E-0002
  eTotal_cr(2) = 2.098106740697102887138747462358879E-0002
  eTotal_cr(3) = -4.947836774554146242743879469117019E-0003 
  eTotal_cr(4) = -2.200538471062097827508428688343626E-0023
  eTotal_cr(5) = 1.626156234791463403906633999265950E-0018
  eTotal_cr(6) = -5.173646474554571438535865727563457E-0022 
  ec_cr(1) = 7.516949102268077886890296213096008E-0007
  ec_cr(2) = 7.514811570866197776297212840290740E-0007
  ec_cr(3) = 4.991349024114494214998671850480605E-0008
  ec_cr(4) = 9.394746830813433890968267300840828E-0023
  ec_cr(5) = 2.033077291111084252605314594806586E-0019
  ec_cr(6) = 2.020292886720182300477861899658225E-0022
  tbar_cr(1) = 6.809988454569476034633736169561215E-0022
  tbar_cr(2) = 3.430371170187822282837686316270265E-0002
  tbar_cr(3) = -5.008422201008775147129210613415190E-0022

  result = jacobian(C,ec_cr,tbar_cr,lch,alpha,eta,GIc,GIIc,e22,eTotal_cr)

  call printarray(result)

    contains

      subroutine printarray(array)
        implicit none
        real*8, dimension(3,3), intent(in) :: array
        integer :: i
        do i = 1, ubound(array, 1)
          print *, array(i, :)
        end do
      end subroutine printarray

end program jacobian_test

